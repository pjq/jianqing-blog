---
title: "给内核patch中文补丁"
date: 2008-12-28
author: pengjianqing
categories: ['gentoo', 'Linux']
tags: ['firefox', 'patch', '中文', '内核', '终端', '补丁', '驱动']
---

以前在终端下要显示中文都要另外再安装zhcon,大概知道也有中文补丁但一直没有在意,今天在linuxsir上无意中看到了一个中文补丁的贴子,就想试试.
之前没打过补丁,所以先搜了一下patch的用法,下面是我的大概操作过程:
1.先将补丁(*.patch)解压放到/usr/src/linux 下面
2.patch -p1 >*.c
然后再把加的这部分代码提到#include <>下面去.
然后再编译一下,copy内核,用新内核引导到终端,ls 一下,可以正常显示中文了.

Gentoo内核昨天又升级了(NVIDIA驱动也升级了),直接从2.6.26-r4干到了2.6.27-r7,升级真多,前两天圣诞2.6.28的内核才刚出来,下面是简易升级过程:
1.emerge -uDN world
2.将原先的/usr/src/linux 软链接删掉,
然后将新内核链接过去
3.拷贝一下先前的.config到新的内核目录下.
4.然后make  menuconfig,一般我都不需要重新配置了,然后直接保存就行了,这种有可能会有问题,但我一直是这样操作的,现在也没有发现什么问题.
5.然后再time make
6.OK,编译成功,
make modules_install,
拷贝新内核,成功引导系统.
7.进入系统,再重新编译相关模块
modules-rebuild rebuild
这里一般不会太多,主要是一个显卡驱动,还有VirtualBox 模块.
8.至此一个内核的升级就基本完成.

然后再照着上面的方法patch上了中文补丁,ls -lh  /boot/kernel-*一看,这个中文补丁居然把内核增加了大概0.4M,原来都是2M,现在差不多2.5M了.

这几天将firefox升级到了3.0.5,发现很容易假死,随便打开几个网页,然后点TAP,很容易造成假死,要过10S左右才能恢复过来,这个很是郁闷,不知道为什么会有这个问题,之前的都没有一点问题,为什么一升级就会有这样的问题.