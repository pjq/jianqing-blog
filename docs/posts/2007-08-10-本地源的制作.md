---
title: "本地源的制作"
date: 2007-08-10
author: pengjianqing
categories: ['Ubuntu']
---

新手，如有错误或不合理之处，敬请指正
如果按旧贴已经制作好了本地源，无需重新制作，只需参照新的源地址写法加入本地源即可，并删除别其目录减少空间的占用：）

执行过sudo apt-get update && sudo apt-get disk-upgrade && sudo apt-get install XXX操作后，更新包和系统光盘里面没有的软件包都会保存在
代码:
/var/cache/apt/archives/
本文将以这些包为基础来制作本地安装源。所进行的操作建议新手在自己的根目录里进行，以避免权限的麻烦。以下为制作步骤：
1.安装必要的软件包dpkg-dev
代码:
sudo apt-get install dpkg-dev

2.备份已经下载到本机的软件包和更新
代码:
mkdir ~/edgy    #在根目录建立edgy文件夹,该目录名可选
sudo cp -a /var/cache/apt/archives/*   ~/edgy

3.建立包列表及依赖信息文件
代码:
cd ~/
sudo dpkg-scanpackages edgy /dev/null |gzip >edgy/Packages.gz

该命令执行完成后，将在~/edgy目录下生成一个Packages.gz文件，里面记录了本地包的列表及包依赖信息，sudo apt-get update命令就是为了获取该文件中的信息
4.保存建立好的本地包及Packages.gz
代码:
sudo mv ~/edgy  /media/hda7/linux/soft/packs/
#后面这个保存路径随个人喜好而定

5.至此，本地源就基本建好了，下面是添加源
代码:
sudo vim /etc/apt/sources.list

加入下面的源地址,注意与常见的网络源格式不同
代码:
deb [file:///media/hda7/linux/soft/packs](///media/hda7/linux/soft/packs) edgy/

保存退出vim，然后在终端里执行：
代码:
sudo apt-get update && sudo apt-get dist-upgrade

接下来就是正常的apt-get install了，安装本地源上的包时，该包不会再复制到
代码:
/var/cache/apt/archives/

里面，而是直接安装，所以不用担心会多浪费硬盘空间。