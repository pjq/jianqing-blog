---
title: "ChatGPT-与小爱同学对话"
date: 2023-02-17
author: pengjianqing
categories: ['Tech']
tags: ['AI', 'ChatGPT', '小爱同学']
---

![](../images/153b899c.png)

小爱同学作为家里语音助手，掌管着家里的智能家居的控制，只是脑袋有点不灵光，进化多年，还是人工智障的样子

很早就想着实现小爱同学与ChatGPT的联动，今天搜了一下，确实看到了一些方案。晚上折腾了一下，成功打通小爱同学与ChatGPT连接，基于这个基础，后面可以实现更多功能，目前仅实现了，小爱同学可以从ChatGPT那里返回问题答案进行输出。

主要参考以下项目

- [https://github.com/yihong0618/xiaogpt](https://github.com/yihong0618/xiaogpt)

还有一个对米家进行逆向的repo, 可以用来命令行控制家里的智能设备，比如灯，空调，小爱音箱等，基本上我家里的都可以控制。

- [https://github.com/Yonsm/MiService](https://github.com/Yonsm/MiService)

- https://github.com/acheong08/ChatGPT

安装过程简单列一下

```
`git clone git@github.com:acheong08/ChatGPT.git
pip3 install revChatGPT
cat ~/.config/revChatGPT/config.json;
{
	"paid":true,
"access_token":"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ik1UaEVOVUpHTkVNMVFURTRNMEZCTWpkQ05UZzVNRFUxUlRVd1FVSkRNRU13UmtGRVFrRXpSZyJ9.eyJodHRwczovL2FwaS5vcGVuYWkuY29tL3Byb2ZpbGUiOnsiZW1haWwxxxx"
}
pip3 install miservice
export MI_USER=
export MI_PASS=

export MI_DID="891xxxxx"
export MI_HARDWARE="LX01"

sudo ln -s ~/workspace/Xiaoai-ChatGPT/MiService/micli.py /usr/local/bin/micli;
python3 micli.py list
[
  {
    "name": "遥控器",
    "model": "chuangmi.ir.v2",
    "did": "xxxx",
    "token": "xxxx"
  },
  {
    "name": "阳台摄像机",
    "model": "yunyi.camera.v1",
    "did": "yunyi.xxxxx",
    "token": "xxxx"
  },

micli spec xiaomi.wifispeaker.lx04
# Generated by https://github.com/Yonsm/MiService
# http://miot-spec.org/miot-spec-v2/instance?type=urn:miot-spec-v2:device:speaker:0000A015:xiaomi-lx04:2

Device_Information = 1
    Device_Manufacturer = 1
    Device_Model = 2
    Device_Serial_Number = 3
    Current_Firmware_Version = 4
`
```

如果一切顺利，就可以用命令行进行小爱同学控制了，这个命令就是用小爱同学进行语音播报

```
`micli 5-1 你今天怎么样呀`
```

## 运行效果

python3 xiaogpt.py --hardware "$MI_HARDWARE"
5-1
do_action 5-1:正在启动小爱同学和ChatGPT的连接，问题以帮我回答开头的会进行转发
0
No new xiao ai record
Now listening xiaoai new message timestamp: 1676563138995
讲一个睡前故事，请用100字以内回答
Running chatgpt ask maybe a little slow we do not pay
do_action 5-1:正在问GPT我们不是会员还用的API有点慢
0
以下是GPT的回答:很好！这是一个关于勇敢的故事。有一天，一只小兔子在森林里迷路了，他非常害怕，但是他决定不放弃，勇敢地面对挑战。他走了很
长的路，终于找到了家的路。小兔子学会了，勇敢面对困难是成功的关键。睡个好觉吧，明天一定会更好！
以下是小爱的回答: 好呢，宝宝巴士睡前故事晚安宝贝 睡觉的小鲤鱼来啦
do_action
5-1:以下是GPT的回答:很好！这是一个关于勇敢的故事。有一天，一只小兔子在森林里迷路了，他非常害怕，但是他决定不放弃，勇敢地面对挑战。
他走了很长的路，终于找到了家的路。小兔子学会了，勇敢面对困难是成功的关键。睡个好觉吧，明天一定会更好！
0
Now listening xiaoai new message timestamp: 1676563340034
Now listening xiaoai new message timestamp: 1676563353643
No new xiao ai record

这样当你以"帮我回答"开头问小爱同学问题的时候就会转发到ChatGPT，然后再用小爱同学进行播报。