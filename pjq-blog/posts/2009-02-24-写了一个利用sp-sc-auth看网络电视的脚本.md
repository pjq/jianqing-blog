---
title: "写了一个利用sp-sc-auth看网络电视的脚本"
date: 2009-02-24
author: pengjianqing
categories: ['shell']
---

[详见](http://gentoo-pjq.vicp.net/bbs/viewtopic.php?f=2&t=37&p=44&sid=492a625a38a1fd9af6983039d5443c01#p44)：http://gentoo-pjq.vicp.net/bbs/viewtopic.php?f=2&t=37&p=44&sid=492a625a38a1fd9af6983039d5443c01#p44

```

pjq@gentoo-pjq ~/sopcast $ cat psop.sh
#!/bin/sh
#pjq@gentoo-pjq.vicp.net
#USAGE:
#./psop.sh tvname
#example:
#./psop.sh cctv-1
#then you can use mplayer to play the tv
#mplayer http://127.0.0.1:8908

#define const
GCHLXML=/tmp/gchlxml
ITEM=/tmp/item
NAME=/tmp/name
TEMP=/tmp/tempfile
TV=$1
#Get the gchlxml if no existing file
[ -f $GCHLXML ] || wget -O $GCHLXML http://channel.sopcast.com/gchlxml

cat $GCHLXML|awk -F "item" '{print $2}'|sed 's/>//g'|sed 's/$ITEM
cat $GCHLXML|awk -F "name" '{print $2}'|sed  's/>//g'|sed 's/\"//g'|sed 's/$NAME
paste -d "@" $NAME $ITEM|awk 'NF>0' |sort|uniq|grep -n "" >$TEMP

grep -i  $TV $TEMP
echo -n "Input TV number:"
read  number
#echo $number

V=`grep -i  $TV $TEMP| grep "$number:" |cut -d "@" -f2`
N=`grep -i  $TV $TEMP| grep "$number:" |cut -d "@" -f1`
echo "Now playing:$N "
pkill sp-sc-auth
sp-sc-auth  $V 3908 8908 >/dev/null &

rm $TEMP $NAME $ITEM

#[ $2 == 'p' ] && sleep 5 && mplayer http://127.0.0.1:8908

```

运行效果1：
pjq@gentoo-pjq ~/sopcast $ ./psop.sh cctv-1
72: en:CCTV-1 cn:CCTV-1综合频道CCTV-1 [CCTV-1综合频道]@sop://broker.sopcast.com:3912/15102
Input TV number:72
Now playing:72: en:CCTV-1 cn:CCTV-1综合频道CCTV-1 [CCTV-1综合频道]

运行效果2：
pjq@gentoo-pjq ~/sopcast $ ./psop.sh cctv
10: en:CCTV-5 cn:CCTV-5体育频道CCTV-5 [CCTV-5体育频道]@sop://broker.sopcast.com:3912/6002
72: en:CCTV-1 cn:CCTV-1综合频道CCTV-1 [CCTV-1综合频道]@sop://broker.sopcast.com:3912/15102
74: en:CCTV-2 Finance cn:CCTV-2财经频道CCTV-2@sop://broker.sopcast.com:3912/15103
107: en:CCTV-3 Comedy cn:CCTV-3 综艺频道CCTV-3@sop://broker.sopcast.com:3912/8888
153: en:CCTV-6 Movie cn:CCTV-6电影频道CCTV-6@sop://broker.sopcast.com:3912/6028
180: en:CCTV-8 cn:CCTV-8电视剧频道CCTV-8@sop://broker.sopcast.com:3912/15163
186: en:CCTV-5 cn:CCTV-5体育频道CCTV-5 [CCTV-5体育频道]@sop://broker.sopcast.com:3912/6002
192: en:CCTV-6 Movie cn:CCTV-6电影频道CCTV-6@sop://broker.sopcast.com:3912/6028
194: en:CCTV-3 Comedy cn:CCTV-3 综艺频道CCTV-3@sop://broker.sopcast.com:3912/8888
196: en:CCTV-2 Finance cn:CCTV-2财经频道CCTV-2@sop://broker.sopcast.com:3912/15103
Input TV number:10
Now playing:10: en:CCTV-5 cn:CCTV-5体育频道CCTV-5 [CCTV-5体育频道]

运行过后用mplayer就可以进行播放了：
mplayer http://127.0.0.1:8908

如果要在终端下播放(ctrl+alt+F[1...6])，可以加几个参数：
mplayer http://127.0.0.1:8908 -zoom -x 640 -y -480 -vo fbdev2

这样就可以不进图形界面就可以看网络电视了。